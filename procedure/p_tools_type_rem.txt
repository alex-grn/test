CREATE OR REPLACE FUNCTION public.p_tools_type_rem (
  sval text,
  siso text,
  nd numeric
)
RETURNS text AS
$body$
declare

begin
		if COALESCE(ND, 0) = 1
		then
			if SISO in ('RUB', 'USD', 'EUR', 'JPY', 'GBP')
			then
				return '/100';
			elsif SISO = 'CNY' -- китайская юань
			then
				return '/10/10';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		end if;
		if SVAL = '11k'
		then
			if SISO = 'RUB' -- рубль
			then
				return ' копеек';
			elsif SISO = 'USD' -- доллар
			then
				return ' центов';
			elsif SISO = 'EUR' -- евро
			then
				return ' центов ';
			elsif SISO = 'JPY' -- японская иена
			then
				return ' сен';
			elsif SISO = 'GBP' -- фунт стерлинг
			then
				return ' пенсов';
			elsif SISO = 'CNY' -- китайская юань
			then
				return ' йао';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		elsif SVAL = '12k'
		then
			if SISO = 'RUB' -- рубль
			then
				return ' копеек';
			elsif SISO = 'USD' -- доллар
			then
				return ' центов';
			elsif SISO = 'EUR' -- евро
			then
				return ' центов';
			elsif SISO = 'JPY' -- японская иена
			then
				return ' сен';
			elsif SISO = 'GBP' -- фунт стерлинг
			then
				return ' пенсов';
			elsif SISO = 'CNY' -- китайская юань
			then
				return ' йао';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		elsif SVAL = '13k'
		then
			if SISO = 'RUB' -- рубль
			then
				return ' копеек';
			elsif SISO = 'USD' -- доллар
			then
				return ' центов';
			elsif SISO = 'EUR' -- евро
			then
				return ' центов';
			elsif SISO = 'JPY' -- японская иена
			then
				return ' сен';
			elsif SISO = 'GBP' -- фунт стерлинг
			then
				return ' пенсов';
			elsif SISO = 'CNY' -- китайская юань
			then
				return ' йао';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		elsif SVAL = '14k'
		then
			if SISO = 'RUB' -- рубль
			then
				return ' копеек';
			elsif SISO = 'USD' -- доллар
			then
				return ' центов';
			elsif SISO = 'EUR' -- евро
			then
				return ' центов';
			elsif SISO = 'JPY' -- японская иена
			then
				return ' сен';
			elsif SISO = 'GBP' -- фунт стерлинг
			then
				return ' пенсов';
			elsif SISO = 'CNY' -- китайская юань
			then
				return ' йао';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		elsif SVAL = '1k'
		then
			if SISO = 'RUB' -- рубль
			then
				return ' копейка';
			elsif SISO = 'USD' -- доллар
			then
				return ' цент';
			elsif SISO = 'EUR' -- евро
			then
				return ' цент';
			elsif SISO = 'JPY' -- японская иена
			then
				return ' сен';
			elsif SISO = 'GBP' -- фунт стерлинг
			then
				return ' пенсов';
			elsif SISO = 'CNY' -- китайская юань
			then
				return ' йао';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		elsif SVAL = '2k'
		then
			if SISO = 'RUB' -- рубль
			then
				return ' копейки';
			elsif SISO = 'USD' -- доллар
			then
				return ' цента';
			elsif SISO = 'EUR' -- евро
			then
				return ' цента';
			elsif SISO = 'JPY' -- японская иена
			then
				return ' сен';
			elsif SISO = 'GBP' -- фунт стерлинг
			then
				return ' пенса';
			elsif SISO = 'CNY' -- китайская юань
			then
				return ' йао';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		elsif SVAL = '3k'
		then
			if SISO = 'RUB' -- рубль
			then
				return ' копейки';
			elsif SISO = 'USD' -- доллар
			then
				return ' цента';
			elsif SISO = 'EUR' -- евро
			then
				return ' цента';
			elsif SISO = 'JPY' -- японская иена
			then
				return ' сен';
			elsif SISO = 'GBP' -- фунт стерлинг
			then
				return ' пенса';
			elsif SISO = 'CNY' -- китайская юань
			then
				return ' йао';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		elsif SVAL = '4k'
		then
			if SISO = 'RUB' -- рубль
			then
				return ' копейки';
			elsif SISO = 'USD' -- доллар
			then
				return ' цента';
			elsif SISO = 'EUR' -- евро
			then
				return ' цента';
			elsif SISO = 'JPY' -- японская иена
			then
				return ' сен';
			elsif SISO = 'GBP' -- фунт стерлинг
			then
				return ' пенса';
			elsif SISO = 'CNY' -- китайская юань
			then
				return ' йао';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		elsif SVAL = 'k'
		then
			if SISO = 'RUB' -- рубль
			then
				return ' копеек';
			elsif SISO = 'USD' -- доллар
			then
				return ' центов ';
			elsif SISO = 'EUR' -- евро
			then
				return ' центов';
			elsif SISO = 'JPY' -- японская иена
			then
				return ' сен';
			elsif SISO = 'GBP' -- фунт стерлинг
			then
				return ' пенсов';
			elsif SISO = 'CNY' -- китайская юань
			then
				return ' йао';
			else
				raise using message = 'Код валюты "%s", не пределен!';
			end if;
		end if;
end;
$body$
LANGUAGE 'plpgsql'
VOLATILE
CALLED ON NULL INPUT
SECURITY INVOKER
COST 100;

ALTER FUNCTION public.p_tools_type_rem (sval text, siso text, nd numeric)
  OWNER TO magicbox;
CREATE OR REPLACE FUNCTION public.t_roleprivs_after_iu (
)
RETURNS trigger AS
$body$
 begin 
   if tg_op = 'INSERT' then
     update roleprivs
        set access = coalesce((select access from roleprivs where ID = NEW.HID), true)
      where ID = NEW.ID;
   elsif tg_op = 'UPDATE' then
     update roleprivs
        set access = NEW.access
      where HID = NEW.ID;
   end if;
   return NEW;
 end;
$body$
LANGUAGE 'plpgsql'
VOLATILE
CALLED ON NULL INPUT
SECURITY INVOKER
COST 100;

ALTER FUNCTION public.t_roleprivs_after_iu ()
  OWNER TO magicbox;
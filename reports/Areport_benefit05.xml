<?xml version="1.0" encoding="UTF-8"?>
<report name="report">
    <templates>
        <template code="DEFAULT" documentName="Areport_benefit05.xls" documentPath="Areport_benefit05.xls" outputType="xls" outputNamePattern="Areport_benefit05.xls"/>
    </templates>
    <rootBand name="Root" orientation="H">
        <bands>
		    <band name="Header" orientation="H">
				<queries>
                     <query name="Header" type="sql">
                        <script>
							select 'за период с '||
									case ${repmonth}::integer
									 when 1 then '€нвар€'
									 when 2 then 'феврал€'
									 when 3 then 'марта'
									 when 4 then 'апрел€'
									 when 5 then 'ма€'
									 when 6 then 'июн€'
									 when 7 then 'июл€'
									 when 8 then 'августа'
									 when 9 then 'сент€бр€'
									 when 10 then 'окт€бр€'
									 when 11 then 'но€бр€'
									 when 12 then 'декабр€'
									 end
									 ||' по '||
									 case ${repmonthby}::integer
									 when 1 then '€нварь'
									 when 2 then 'февраль'
									 when 3 then 'март'
									 when 4 then 'апрель'
									 when 5 then 'май'
									 when 6 then 'июнь'
									 when 7 then 'июль'
									 when 8 then 'август'
									 when 9 then 'сент€брь'
									 when 10 then 'окт€брь'
									 when 11 then 'но€брь'
									 when 12 then 'декабрь'
									 end
									 ||' '||${repyear}::text||' года'  as DATEREPORT
						</script>
                     </query>
                </queries>
			</band>
			<band name="totaldata" orientation="H">
				<queries>
                    <query name="totaldata" type="sql">
                        <script>
							select b05r.region,
								   b05r.pers_count,
								   b05r.reg_coeff,
								   b05r.norm_sum,
								   b05r.norm_sum_by_reg_coeff,
								   b05r.pers_sum_by_reg_coeff,
								   b05r.pay_sum,
								   b05r.dist_sum,
								   b05r.row_ps1
							  from benefit05_rep b05r
							 where b05r.uid = ${uid}::BIGINT
							   and b05r.row_ps0 = 0
							 order by b05r.code_area,
									  b05r.row_ps0,
									  b05r.code_region,
									  b05r.row_ps1;
                        </script>
                    </query>
                </queries>
            </band>
            <band name="areadata" orientation="H">
				<bands>
					<band name="regiondata" orientation="H">
						<queries>
                            <query name="regiondata" type="sql">
                                <script>
									select b05r.region,
										   b05r.pers_count,
										   b05r.reg_coeff,
										   b05r.norm_sum,
										   b05r.norm_sum_by_reg_coeff,
										   b05r.pers_sum_by_reg_coeff,
										   b05r.pay_sum,
										   b05r.dist_sum,
										   b05r.code_area,
										   b05r.row_ps0,
										   b05r.code_region,
										   b05r.row_ps1
									  from benefit05_rep b05r
									 where b05r.uid = ${uid}::BIGINT
									   and b05r.row_ps1 not in (0,1)
									   and b05r.code_area = ${areadata.code_area}
									 order by b05r.code_area,
											  b05r.row_ps0,
											  b05r.code_region,
											  b05r.row_ps1;
                                </script>
                            </query>
                        </queries>
					</band>
				</bands>
                <queries>
                    <query name="areadata" type="sql">
                        <script>
							select b05r.region,
								   b05r.pers_count,
								   b05r.reg_coeff,
								   b05r.norm_sum,
								   b05r.norm_sum_by_reg_coeff,
								   b05r.pers_sum_by_reg_coeff,
								   b05r.pay_sum,
								   b05r.dist_sum,
								   b05r.code_area,
								   b05r.row_ps0,
								   b05r.code_region,
								   b05r.row_ps1
							  from benefit05_rep b05r
							 where b05r.uid = ${uid}::BIGINT
                               and b05r.row_ps0 = 1
                               and b05r.row_ps1 = 1
							 order by b05r.code_area,
									  b05r.row_ps0,
									  b05r.code_region,
									  b05r.row_ps1;
                        </script>
                    </query>
                </queries>
            </band>
        </bands>
        <queries/>
    </rootBand>
</report>
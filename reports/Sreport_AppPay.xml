<?xml version="1.0" encoding="UTF-8"?>
<report name="report">
    <templates>
        <template code="DEFAULT" documentName="Sreport_AppPay.xls" documentPath="Sreport_AppPay.xls" outputType="xls" outputNamePattern="Sreport_AppPay.xls"/>
    </templates>
    <rootBand name="Root" orientation="H">
        <bands>
			<!--Ћист —вод-->
			<!--Ўапка-->
		    <band name="Header" orientation="H">
				<queries>
                     <query name="Header" type="sql">
                        <script>
							select 'за период с €нвар€ по '||
									 case ${repmonthby}::integer
									 when 1 then '€нварь'
									 when 2 then 'февраль'
									 when 3 then 'март'
									 when 4 then 'апрель'
									 when 5 then 'май'
									 when 6 then 'июнь'
									 when 7 then 'июль'
									 when 8 then 'август'
									 when 9 then 'сент€брь'
									 when 10 then 'окт€брь'
									 when 11 then 'но€брь'
									 when 12 then 'декабрь'
									 end
									 ||' '||${repyear}::text||' года'  as DATEREPORT,
									 (select s.name from SUBJECTSDIR s where s.id = ${subjectsdirid}::integer) as SUBJECTSDIR
						</script>
                     </query>
                </queries>
			</band>		
			<!--строки-->
			<band name="spec" orientation="H">
				<queries>
                     <query name="spec" type="sql">
                        <script>
							select (select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer  between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::integer)  as number_of_recipients,
								COALESCE(sum(COALESCE(p.paysum,0)),0) as benefits_paid
							from benefit01 b,
								benefit01payment p,
								BENEFITSPACKETS z
							where p.benefit01id = b.id 
							and b.benefitspacketsid = z.id
							and Z.repmonth::integer between 1 and ${repmonthby}::integer
							and z.repyear = ${repyear}::integer;
						</script>
                     </query>
                </queries>
			</band>	
			<band name="spec1" orientation="H">
				<queries>
                     <query name="spec1" type="sql">
                        <script>
							select (select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer  between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::integer)  as number_of_recipients,
								COALESCE(sum(COALESCE(p.paysum,0)),0) as benefits_paid
							from benefit02 b,
								benefit02payment p,
								BENEFITSPACKETS z
							where p.benefit02id = b.id 
							and b.benefitspacketsid = z.id
							and Z.repmonth::integer between 1 and ${repmonthby}::integer
							and z.repyear = ${repyear}::integer;
						</script>
                     </query>
                </queries>
			</band>		
			<band name="spec2" orientation="H">
				<queries>
                     <query name="spec2" type="sql">
                        <script>
							select (select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer  between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::integer)  as number_of_recipients,
								COALESCE(sum(COALESCE(p.paysum,0)),0) as benefits_paid
							from benefit03 b,
								benefit03payment p,
								BENEFITSPACKETS z
							where p.benefit03id = b.id 
							and b.benefitspacketsid = z.id
							and Z.repmonth::integer between 1 and ${repmonthby}::integer
							and z.repyear = ${repyear}::integer;
						</script>
                     </query>
                </queries>
			</band>		
			<band name="spec3" orientation="H">
				<queries>
                     <query name="spec3" type="sql">
                        <script>
							select (select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer  between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::integer)  as number_of_recipients,
								COALESCE(sum(COALESCE(p.paysum,0)),0) as benefits_paid
							from benefit04 b,
								benefit04payment p,
								BENEFITSPACKETS z
							where p.benefit04id = b.id 
							and b.benefitspacketsid = z.id
							and Z.repmonth::integer between 1 and ${repmonthby}::integer
							and z.repyear = ${repyear}::integer;
						</script>
                     </query>
                </queries>
			</band>		
			<band name="spec4" orientation="H">
				<queries>
                     <query name="spec4" type="sql">
                        <script>
							select (select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer  between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::integer)  as number_of_recipients,
								COALESCE(sum(COALESCE(p.paysum,0)),0) as benefits_paid
							from benefit05 b,
								benefit05payment p,
								BENEFITSPACKETS z
							where p.benefit05id = b.id 
							and b.benefitspacketsid = z.id
							and Z.repmonth::integer between 1 and ${repmonthby}::integer
							and z.repyear = ${repyear}::integer;
						</script>
                     </query>
                </queries>
			</band>		
			<band name="spec5" orientation="H">
				<queries>
                     <query name="spec5" type="sql">
                        <script>
							select (select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer  between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::integer)  as number_of_recipients,
								COALESCE(sum(COALESCE(p.paysum,0)),0) as benefits_paid
							from benefit06 b,
								benefit06payment p,
								BENEFITSPACKETS z
							where p.benefit06id = b.id 
							and b.benefitspacketsid = z.id
							and Z.repmonth::integer between 1 and ${repmonthby}::integer
							and z.repyear = ${repyear}::integer;
						</script>
                     </query>
                </queries>
			</band>		
			<band name="spec6" orientation="H">
				<queries>
                     <query name="spec6" type="sql">
                        <script>
							select (select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer  between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::integer)  as number_of_recipients,
								COALESCE(sum(COALESCE(p.paysum,0)),0) as benefits_paid
							from benefit07 b,
								benefit07payment p,
								BENEFITSPACKETS z
							where p.benefit07id = b.id 
							and b.benefitspacketsid = z.id
							and Z.repmonth::integer between 1 and ${repmonthby}::integer
							and z.repyear = ${repyear}::integer;
						</script>
                     </query>
                </queries>
			</band>					
			<!--Ћист по уходу за ребенком-->
			<!--Ўапка-->
			<band name="Header2" orientation="H">
				<queries>
                     <query name="Header2" type="sql">
                        <script>
							select 'за период с €нвар€ по '||
									 case ${repmonthby}::integer
									 when 1 then '€нварь'
									 when 2 then 'февраль'
									 when 3 then 'март'
									 when 4 then 'апрель'
									 when 5 then 'май'
									 when 6 then 'июнь'
									 when 7 then 'июль'
									 when 8 then 'август'
									 when 9 then 'сент€брь'
									 when 10 then 'окт€брь'
									 when 11 then 'но€брь'
									 when 12 then 'декабрь'
									 end
									 ||' '||${repyear}::text||' года'  as DATEREPORT,
									 (select s.name from SUBJECTSDIR s where s.id = ${subjectsdirid}::integer) as SUBJECTSDIR
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l2_spec" orientation="H">
				<queries>
                     <query name="l2_spec" type="sql">
                        <script>
							select COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid;
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l2_spec1" orientation="H">
				<bands>
					<band name="l2_spec2" orientation="H">
						<queries>
							<query name="l2_spec2" type="sql">
								<script>
								select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.name as subject,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
								from benefit01 b 
									inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
									inner join subjectsdir ss on ss.id = g.subjectsdirid and ss.fedreg = ${l2_spec1.subject}
								group by ss.name,ss.id) ff
                           group by ff.subject
								</script>
							</query>
						</queries>
					</band>
				</bands>
				<queries>
                     <query name="l2_spec1" type="sql">
                        <script>
							select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.fedreg as subject,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit01 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit01 b,BENEFITSPACKETS z, benefit01payment p where p.benefit01id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
							from benefit01 b 
								inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
								inner join subjectsdir ss on ss.id = g.subjectsdirid
							group by ss.fedreg,ss.id) ff
                           group by ff.subject
						</script>
                     </query>
                </queries>
			</band>	
		<!--Ћист по беременности и родам-->
			<!--Ўапка-->
			<band name="Header3" orientation="H">
				<queries>
                     <query name="Header3" type="sql">
                        <script>
							select 'за период с €нвар€ по '||
									 case ${repmonthby}::integer
									 when 1 then '€нварь'
									 when 2 then 'февраль'
									 when 3 then 'март'
									 when 4 then 'апрель'
									 when 5 then 'май'
									 when 6 then 'июнь'
									 when 7 then 'июль'
									 when 8 then 'август'
									 when 9 then 'сент€брь'
									 when 10 then 'окт€брь'
									 when 11 then 'но€брь'
									 when 12 then 'декабрь'
									 end
									 ||' '||${repyear}::text||' года'  as DATEREPORT,
									 (select s.name from SUBJECTSDIR s where s.id = ${subjectsdirid}::integer) as SUBJECTSDIR
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l3_spec" orientation="H">
				<queries>
                     <query name="l3_spec" type="sql">
                        <script>
							select COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid;
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l3_spec1" orientation="H">
				<bands>
					<band name="l3_spec2" orientation="H">
						<queries>
							<query name="l3_spec2" type="sql">
								<script>
								select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.name as subject,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
								from benefit02 b 
									inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
									inner join subjectsdir ss on ss.id = g.subjectsdirid and ss.fedreg = ${l3_spec1.subject}
								group by ss.name,ss.id) ff
                           group by ff.subject
								</script>
							</query>
						</queries>
					</band>
				</bands>
				<queries>
                     <query name="l3_spec1" type="sql">
                        <script>
							select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.fedreg as subject,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit02 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit02 b,BENEFITSPACKETS z, benefit02payment p where p.benefit02id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
							from benefit02 b 
								inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
								inner join subjectsdir ss on ss.id = g.subjectsdirid
							group by ss.fedreg,ss.id) ff
                           group by ff.subject
						</script>
                     </query>
                </queries>
			</band>	
			<!--Ћист по ранним срокам беременности 4-->
			<!--Ўапка-->
			<band name="Header4" orientation="H">
				<queries>
                     <query name="Header4" type="sql">
                        <script>
							select 'за период с €нвар€ по '||
									 case ${repmonthby}::integer
									 when 1 then '€нварь'
									 when 2 then 'февраль'
									 when 3 then 'март'
									 when 4 then 'апрель'
									 when 5 then 'май'
									 when 6 then 'июнь'
									 when 7 then 'июль'
									 when 8 then 'август'
									 when 9 then 'сент€брь'
									 when 10 then 'окт€брь'
									 when 11 then 'но€брь'
									 when 12 then 'декабрь'
									 end
									 ||' '||${repyear}::text||' года'  as DATEREPORT,
									 (select s.name from SUBJECTSDIR s where s.id = ${subjectsdirid}::integer) as SUBJECTSDIR
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l4_spec" orientation="H">
				<queries>
                     <query name="l4_spec" type="sql">
                        <script>
							select COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid;
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l4_spec1" orientation="H">
				<bands>
					<band name="l4_spec2" orientation="H">
						<queries>
							<query name="l4_spec2" type="sql">
								<script>
								select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.name as subject,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
								from benefit03 b 
									inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
									inner join subjectsdir ss on ss.id = g.subjectsdirid and ss.fedreg = ${l4_spec1.subject}
								group by ss.name,ss.id) ff
                           group by ff.subject
								</script>
							</query>
						</queries>
					</band>
				</bands>
				<queries>
                     <query name="l4_spec1" type="sql">
                        <script>
							select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.fedreg as subject,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit03 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit03 b,BENEFITSPACKETS z, benefit03payment p where p.benefit03id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
							from benefit03 b 
								inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
								inner join subjectsdir ss on ss.id = g.subjectsdirid
							group by ss.fedreg,ss.id) ff
                           group by ff.subject
						</script>
                     </query>
                </queries>
			</band>	
			<!--Ћист при рождении ребенка 5-->
			<!--Ўапка-->
			<band name="Header5" orientation="H">
				<queries>
                     <query name="Header5" type="sql">
                        <script>
							select 'за период с €нвар€ по '||
									 case ${repmonthby}::integer
									 when 1 then '€нварь'
									 when 2 then 'февраль'
									 when 3 then 'март'
									 when 4 then 'апрель'
									 when 5 then 'май'
									 when 6 then 'июнь'
									 when 7 then 'июль'
									 when 8 then 'август'
									 when 9 then 'сент€брь'
									 when 10 then 'окт€брь'
									 when 11 then 'но€брь'
									 when 12 then 'декабрь'
									 end
									 ||' '||${repyear}::text||' года'  as DATEREPORT,
									 (select s.name from SUBJECTSDIR s where s.id = ${subjectsdirid}::integer) as SUBJECTSDIR
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l5_spec" orientation="H">
				<queries>
                     <query name="l5_spec" type="sql">
                        <script>
							select COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid;
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l5_spec1" orientation="H">
				<bands>
					<band name="l5_spec2" orientation="H">
						<queries>
							<query name="l5_spec2" type="sql">
								<script>
								select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.name as subject,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
								from benefit04 b 
									inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
									inner join subjectsdir ss on ss.id = g.subjectsdirid and ss.fedreg = ${l5_spec1.subject}
								group by ss.name,ss.id) ff
                           group by ff.subject
								</script>
							</query>
						</queries>
					</band>
				</bands>
				<queries>
                     <query name="l5_spec1" type="sql">
                        <script>
							select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.fedreg as subject,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit04 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit04 b,BENEFITSPACKETS z, benefit04payment p where p.benefit04id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
							from benefit04 b 
								inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
								inner join subjectsdir ss on ss.id = g.subjectsdirid
							group by ss.fedreg,ss.id) ff
                           group by ff.subject
						</script>
                     </query>
                </queries>
			</band>	
			<!--Ћист на ребенка военослужащего 6-->
			<!--Ўапка-->
			<band name="Header6" orientation="H">
				<queries>
                     <query name="Header6" type="sql">
                        <script>
							select 'за период с €нвар€ по '||
									 case ${repmonthby}::integer
									 when 1 then '€нварь'
									 when 2 then 'февраль'
									 when 3 then 'март'
									 when 4 then 'апрель'
									 when 5 then 'май'
									 when 6 then 'июнь'
									 when 7 then 'июль'
									 when 8 then 'август'
									 when 9 then 'сент€брь'
									 when 10 then 'окт€брь'
									 when 11 then 'но€брь'
									 when 12 then 'декабрь'
									 end
									 ||' '||${repyear}::text||' года'  as DATEREPORT,
									 (select s.name from SUBJECTSDIR s where s.id = ${subjectsdirid}::integer) as SUBJECTSDIR
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l6_spec" orientation="H">
				<queries>
                     <query name="l6_spec" type="sql">
                        <script>
							select COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid;
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l6_spec1" orientation="H">
				<bands>
					<band name="l6_spec2" orientation="H">
						<queries>
							<query name="l6_spec2" type="sql">
								<script>
								select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.name as subject,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
								from benefit05 b 
									inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
									inner join subjectsdir ss on ss.id = g.subjectsdirid and ss.fedreg = ${l6_spec1.subject}
								group by ss.name,ss.id) ff
                           group by ff.subject
								</script>
							</query>
						</queries>
					</band>
				</bands>
				<queries>
                     <query name="l6_spec1" type="sql">
                        <script>
							select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.fedreg as subject,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit05 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit05 b,BENEFITSPACKETS z, benefit05payment p where p.benefit05id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
							from benefit05 b 
								inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
								inner join subjectsdir ss on ss.id = g.subjectsdirid
							group by ss.fedreg,ss.id) ff
                           group by ff.subject
						</script>
                     </query>
                </queries>
			</band>	
			<!--Ћист по беременной жене военного 7-->
			<!--Ўапка-->
			<band name="Header7" orientation="H">
				<queries>
                     <query name="Header7" type="sql">
                        <script>
							select 'за период с €нвар€ по '||
									 case ${repmonthby}::integer
									 when 1 then '€нварь'
									 when 2 then 'февраль'
									 when 3 then 'март'
									 when 4 then 'апрель'
									 when 5 then 'май'
									 when 6 then 'июнь'
									 when 7 then 'июль'
									 when 8 then 'август'
									 when 9 then 'сент€брь'
									 when 10 then 'окт€брь'
									 when 11 then 'но€брь'
									 when 12 then 'декабрь'
									 end
									 ||' '||${repyear}::text||' года'  as DATEREPORT,
									 (select s.name from SUBJECTSDIR s where s.id = ${subjectsdirid}::integer) as SUBJECTSDIR
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l7_spec" orientation="H">
				<queries>
                     <query name="l7_spec" type="sql">
                        <script>
							select COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid;
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l7_spec1" orientation="H">
				<bands>
					<band name="l7_spec2" orientation="H">
						<queries>
							<query name="l7_spec2" type="sql">
								<script>
								select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.name as subject,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
								from benefit06 b 
									inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
									inner join subjectsdir ss on ss.id = g.subjectsdirid and ss.fedreg = ${l7_spec1.subject}
								group by ss.name,ss.id) ff
                           group by ff.subject
								</script>
							</query>
						</queries>
					</band>
				</bands>
				<queries>
                     <query name="l7_spec1" type="sql">
                        <script>
							select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.fedreg as subject,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit06 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit06 b,BENEFITSPACKETS z, benefit06payment p where p.benefit06id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
							from benefit06 b 
								inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
								inner join subjectsdir ss on ss.id = g.subjectsdirid
							group by ss.fedreg,ss.id) ff
                           group by ff.subject
						</script>
                     </query>
                </queries>
			</band>	
			<!--Ћист по уходу за ребенком-->
			<!--Ўапка-->
			<band name="Header8" orientation="H">
				<queries>
                     <query name="Header8" type="sql">
                        <script>
							select 'за период с €нвар€ по '||
									 case ${repmonthby}::integer
									 when 1 then '€нварь'
									 when 2 then 'февраль'
									 when 3 then 'март'
									 when 4 then 'апрель'
									 when 5 then 'май'
									 when 6 then 'июнь'
									 when 7 then 'июль'
									 when 8 then 'август'
									 when 9 then 'сент€брь'
									 when 10 then 'окт€брь'
									 when 11 then 'но€брь'
									 when 12 then 'декабрь'
									 end
									 ||' '||${repyear}::text||' года'  as DATEREPORT,
									 (select s.name from SUBJECTSDIR s where s.id = ${subjectsdirid}::integer) as SUBJECTSDIR
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l8_spec" orientation="H">
				<queries>
                     <query name="l8_spec" type="sql">
                        <script>
							select COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid;
						</script>
                     </query>
                </queries>
			</band>	
			<band name="l8_spec1" orientation="H">
				<bands>
					<band name="l8_spec2" orientation="H">
						<queries>
							<query name="l8_spec2" type="sql">
								<script>
								select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.name as subject,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
								from benefit07 b 
									inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
									inner join subjectsdir ss on ss.id = g.subjectsdirid and ss.fedreg = ${l8_spec1.subject}
								group by ss.name,ss.id) ff
                           group by ff.subject
								</script>
							</query>
						</queries>
					</band>
				</bands>
				<queries>
                     <query name="l8_spec1" type="sql">
                        <script>
							select  ff.subject,
                 		sum(ff.benefits_paid1) as benefits_paid1,sum(ff.benefits_paid2) as benefits_paid2,sum(ff.benefits_paid3) as benefits_paid3,sum(ff.benefits_paid4) as benefits_paid4,
                        sum(ff.benefits_paid5) as benefits_paid5,sum(ff.benefits_paid6) as benefits_paid6,sum(ff.benefits_paid7) as benefits_paid7,sum(ff.benefits_paid8) as benefits_paid8,
                        sum(ff.benefits_paid9) as benefits_paid9,sum(ff.benefits_paid10) as benefits_paid10,sum(ff.benefits_paid11) as benefits_paid11,sum(ff.benefits_paid12) as benefits_paid12,
                        sum(ff.benefits_paid) as benefits_paid,
                        sum(ff.number_of_recipients1) as number_of_recipients1,sum(ff.number_of_recipients2) as number_of_recipients2,sum(ff.number_of_recipients3) as number_of_recipients3,
                        sum(ff.number_of_recipients4) as number_of_recipients4,sum(ff.number_of_recipients5) as number_of_recipients5,sum(ff.number_of_recipients6) as number_of_recipients6,
                        sum(ff.number_of_recipients7) as number_of_recipients7,sum(ff.number_of_recipients8) as number_of_recipients8,sum(ff.number_of_recipients9) as number_of_recipients9,
                        sum(ff.number_of_recipients10) as number_of_recipients10,sum(ff.number_of_recipients11) as number_of_recipients11,sum(ff.number_of_recipients12) as number_of_recipients12,
                        sum(ff.number_of_recipients) as number_of_recipients
                from (	select ss.fedreg as subject,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 1 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0)  as number_of_recipients1,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 1 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=1),0) as benefits_paid1,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 2 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as number_of_recipients2,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 2 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=2),0)  as benefits_paid2,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 3 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as number_of_recipients3,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 3 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=3),0)  as benefits_paid3,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 4 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as number_of_recipients4,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 4 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=4),0)  as benefits_paid4,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 5 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as number_of_recipients5,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 5 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=5),0)  as benefits_paid5,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 6 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as number_of_recipients6,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 6 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=6),0)  as benefits_paid6,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 7 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as number_of_recipients7,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 7 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=7),0)  as benefits_paid7,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 8 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as number_of_recipients8,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 8 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=8),0)  as benefits_paid8,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 9 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as number_of_recipients9,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 9 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=9),0)  as benefits_paid9,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 10 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as number_of_recipients10,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 10 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=10),0)  as benefits_paid10,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 11 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as number_of_recipients11,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 11 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=11),0)  as benefits_paid11,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer = 12 and xx.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as number_of_recipients12,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer = 12 and z.repyear = ${repyear}::bigint and ${repmonthby}::integer>=12),0)  as benefits_paid12,
									COALESCE((select count(*) from benefit07 x, benefitspackets xx where xx.id = x.benefitspacketsid and xx.subjectsdirid = ss.id and xx.repmonth::integer between 1 and ${repmonthby}::integer and xx.repyear = ${repyear}::bigint),0)  as number_of_recipients,
									COALESCE((select sum(p.paysum) from benefit07 b,BENEFITSPACKETS z, benefit07payment p where p.benefit07id = b.id and z.subjectsdirid = ss.id and b.benefitspacketsid = z.id and Z.repmonth::integer between 1 and ${repmonthby}::integer and z.repyear = ${repyear}::bigint),0)  as benefits_paid
							from benefit07 b 
								inner join benefitspackets g on g.id = b.benefitspacketsid and g.repmonth::integer between 1 and ${repmonthby}::integer and g.repyear = ${repyear}::bigint
								inner join subjectsdir ss on ss.id = g.subjectsdirid
							group by ss.fedreg,ss.id) ff
                           group by ff.subject
						</script>
                     </query>
                </queries>
			</band>	
        </bands>
        <queries/>
    </rootBand>
</report>
<?xml version="1.0" encoding="UTF-8"?>
<report name="report">
    <templates>
        <template code="DEFAULT" documentName="card_networks.xlsx" documentPath="card_networks.xlsx" outputType="xlsx" outputNamePattern="card_networks.xlsx"/>
    </templates>
    <rootBand name="Root" orientation="H">
        <bands>
            <band name="Header" orientation="H">
                <queries>
                    <query name="myQueryHead" type="sql">
                        <script>
							SELECT w.name owner_name FROM networks t, owner w WHERE t.id = ${id} ::bigint and w.id=t.ownerid
                        </script>
                    </query>
                </queries>			
			</band>
			
            <band name="Title1" orientation="H">			
			</band>			
			
            <band name="Spec1" orientation="V">
                <queries>
                    <query name="myQuery" type="sql">
                        <script>
                           SELECT w.code            sowner, /*Принадлежность*/
                                  n.name            sname,  /*Наименование*/
                                  n.description     sdescription, /*Описание*/
                                  n.iplvs           siplvs, /*IP*/
                                  n.mask            smask,  /*Маска*/
                                  n.domen           sdomen, /*Домен*/
                                  n.ipall           sipall, /*IP всего*/
                                  n.ipfree          sipfree /*IP свободно*/
                             FROM networks n
                             LEFT JOIN owner w ON w.id=n.ownerid
                           WHERE n.id = ${id} ::bigint;
                        </script>
                    </query>
                </queries>
            </band>
			
            <band name="Title2" orientation="H">			
			</band>
			
            <band name="Spec2" orientation="H">
                <queries>
                    <query name="myQuery" type="sql">
                        <script>
                           SELECT s.ipadres sipadres,
                                  concat(te.code,'\'||e.description) sequipment,
                                  concat(toe.code,'\'||oe.description) sofficeequipment,
                                  concat(tne.code,'\'||ne.description) stypesnetworksequipment,       
                                  s.note snote
                             FROM specificationsip s
                             LEFT JOIN equipment e ON e.id=s.equipmentid
                                LEFT JOIN typesequipment te ON te.id=e.typesequipmentid
                             LEFT JOIN officeequipment oe ON oe.id=s.officeequipmentid
                                LEFT JOIN typesofficeequipment toe ON toe.id=oe.typesofficeequipmentid
                             LEFT JOIN networksequipment ne ON ne.id=s.networksequipmentid
                                LEFT JOIN typesnetworksequipment tne ON tne.id=ne.typesnetworksequipmentid
                            WHERE s.networksid = ${id} ::bigint;
                        </script>
                    </query>
                </queries>
            </band>			
			
            <band name="Footer" orientation="H"/>
        </bands>
    </rootBand>
</report>